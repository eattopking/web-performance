## 项目总结

### 一、课程二维码项目：

踩坑：踩到了数字上下居中的坑，对移动端适配，又有了进一步了解,

主要用到的技术点：
    1、input   type=file的图片上传
    2、 react的renderProps

意义：解决了学生无法联系到老师的问题

### 二、Crm 项目
主要技术点：

1. 首次使用 antd pro 脚手架，踩了配置的坑, 主里面有几个必须项, 首先 antd pro 依附于 umi, config 的配置就是 umi 的 config 的配置, antd pro 的 css 是 cssmodule 的形式的, antd pro 提供了几个一些复杂的业务组件, 可以 npm 安装使用, 在项目中提供了预置的 layouts(容器组件), pages(页面), components(组成组件)
2. g2 可视化,

3. 封装共用的form， table、查询区组件， 减少代码的冗余

踩坑：
1. 踩了 post 请求跨域的坑，(具体原因在收集问题的那里面写的全), 踩了 form 组合展示的坑(具体解决在收集问题的里面)
2. 踩了路由刷新的坑， 路由刷新 state 值就没有了, 只能通过 search 传的值才能保留
3. 自己第一次搭建了一个完整的项目, 知道了 nginx 服务是 web 的容器,
4. 首次使用了 g2 搞可视化，但是感觉有点不好用， 也是踩了一些坑， 现在是只能初始化设置了数据之后， 才能用 changedata 在更改数据， 不知道是不是我用的不对， 现在是这样， 有点不爽，还有就是图表需要 ajax 数据请求完毕在构建， 就是为了解决上面的问题，只能初始化设置了数据之后， 才能用 changedata 在更改数据， 这里感觉也是不太合理的

意义： 运营伙伴可以在工作台中根据饼图直观的查看课堂数据，在客户公海给运营伙伴分配跟进用户， 在我的客户中编辑跟进信息，方便运营伙伴记录跟进信息和统计工作量

### 三、m站课堂首页配置平台开发，（pc配置页面和m的配置结果展示页面都开发了）
### 做可配置的页面， 就是自己确定-套模板，然后就维护这套模板，就行了

技术点：
1. 实现拖拽排序， 可以使用 dragula 这个 npm 包

设计：
1. pc配置平台是分为三个部分， 组件选择区域， 预览区域， 右侧组件配置区域

2. pc配置平台是所见即所得的，保存后在m站显示的结果就是配置的结果

3. m站的展示也是根据自己确定的模板绘制的

4. pc配置平台在代码设置上也是可以配置的， 维护一套模板，控制页面的展示

5. 总结这种可以配置的界面， 所有东西尽量往模板里面放， 所有的配置字段， 使我们传的参数更少

6. 开发的时候要先写好静态页面， 然后在家逻辑， 不要磨蹭， 先快速搞完简单的， 然后在搞难的， 遇到超过两个小时的问题， 直接过， 之后在看

7. 经验,要将大块的， 重复的，封装成自定义hooks， 使用， 这样代码更好, 知道到了img的data-src 和src 配合实现图片的懒加载， data-src就是一个变量， 不会对图片有任何的影响

8. usememo 和 usecallback 要 看情况使用




踩坑：
1. 踩坑了 git 提交后构建的文件夹名字就是不对， 这个时候出现了混乱， 直接重新拉一遍项目就好了， 干别的都是徒劳

2. 要尽量整合到配置里面， 每一项所需要的属性， 这样就减少了props传递的数量, 设置元素的定位到当前， 直接设置元素的focus就可以， 同时需要设置元素的tabIndex， 在设置同意元素的时候， 要先删除之前设置过的tabIndex属性，否则在次设置聚焦就不生效了

3. 踩到的坑， useState的setState对之当前的state值进行操作后更新， 要在使用setState((prev) => {
    // 要使用这种方式完成， 要不然就会有获取不到正确的值的问题
    return prev;
})

意义： 提高了的m站课堂主页的可配置程度，导航栏、轮播图、专栏都支持配置，客户可以控制导航栏、专栏的显示，还可以添加多个专栏，并且可以调整专栏的展示顺序，使客户的课堂主页展示更加灵活，预览区域所见即所得，方便客户实时的查看自己的配置结果


### 四、pc站批量排课

技术点：
1. antd form自定义组件

意义： 解决了原来系列课中只能单节添加直播课，在需要大量排课的场景下，效率过低的情况

### 五、作业小程序项目

小程序端

技术点：
1. 使用taro搭建项目
2. 封装公共组件较少冗余代码
3. 拍照、录音、 录音播放

设计思路：封装通用组件集中使用

优化：
1、 小程序包不能超过2m， 自己使用useReducer, useContext封装建议状态管理，减小包的大小（100k左右）
2、开发环境切换功能，长按选择切换请求路径， 方便测试切换环境

经验积累

1. 使用taro自定义开发小程序的tarbar， 更改选中状态的时候， 不能够通过重新tabbar初始话的router的来判断，而是必须在组件里面写死，
并且切换下一个的时候， 用类组件的时候需要获取自定义tabbar实例更新内部selected， 而使用hooks的时候， 需要使用redux控制， 否则一直会慢半拍，一直选中的都是上一个的, 不能再组件内部控制, 最好不要使用自定义tabbar性能会有问题

2. 每次切换自定义的tabbar， tabbar组件会初始化两次， 这个还没有查到原因

3. 一般需要设置一个开发环境的环境切换机制，  长按弹出切换界面， 此时需要使用自定义的navigationStyle

4. 在存储storage数据的时候， 要根据环境，添加上环境字段， 避免测试环境和线上环境，切换环境的时候， 出现storage数据混乱的情况，比如将测试环境的storage数据带到线上

5. 用户登录的时候， 后端将根据微信login 返回的code+session_Key生成的token设置成无限期， 然后前端只判断checkSession是否过期， 在token存在情况下, 需要使用wx.getsetting获取， 是否有各种权限， 没有的话，主要我们弹出获取权限页面， 如果需要手动触发的话， 不要手动触发的话，直接弹出获取权限弹窗

6. 小程序底部tabbar只能使用图片不能使用图标，小程序的自带tab不能使用网络图片， 只能使用项目里的图片

7. 学生提交的图片使用前端直穿oss的方式， 提高性能， 需要后端给提供直穿url， 并且使用post请求直传，
小程序有自己的上传的api

8. cors跨域携带cookie的是问题， 需要在ajax 中配置withCredentials为true， 让cors跨域的时候，能携带上cookie值， 这里需要注意， 跨域请求能携带的cookie值， 只能是cookie源为自己的请求域名， 或者为当前跨域请求的父级域名

9. taro中的全局事件， 比如分享， 需要在页面中配置才生效， 在组件中配置是无效的

10. 在页面切换到其他页面的时候， 当前页面会被储存在页面栈中， 再次返回页面的时候， 页面内的状态数据， 都会保存，并且taro， 回退页面的时候useEffectE不会执行， useDidShow会执行，所以当回退需要初始化的操作时， 需要在useDidShow中覆盖原有值

pc端：
技术点：
1. 使用canvas封装公共的批改组件
2. 封装公共组件table、form、search 组件，减少冗余代码
3. pc端图片上穿预览、音频上传预览
4. 图片直传oss提高用户体验， 提高性能
5. 使用cors跨域， 这个时候携带父域名的cookie， 需要在ajax中配置  withCredentials为true
6.

难点：
1. canvas计算， 封装canvas批改组件
2. 前端图片直传oss， 没有相关的实际实践， 通过官方文档， 摸索尝试， 实现oss直传





踩坑：

意义：



## 经验积累

### 一. 做项目的准备和步骤

1. 以后做项目，要自己理解需求， 然后根据需求设计完整的方案，根据方案写好逻辑注释
2. 开发之前一定要写技术文档， 写出需要用的技术， 和不知道用什么技术实现的， 和所用技术的难点
3. 要全局， 把整个流程都捋通，把整个流程的注释都写好， 然后根据捋好的注释一气呵成完成开发，
4. 要不然开发都是迷糊的，漏洞百出， 这里的全局逻辑可以写在一个单独的文本文件中，具体的逻辑可以写在对应的组件文件中， 然后把这些东西整理成设计文档， 用于评审， 这样才能清晰的开发
5. 一定要看了要开发代码之后才能评估，需要的开发时间，，最好是先开发一段时间在评估时间，一定要把写样式的时间算进去
6. 开发的时候要先写好静态页面， 然后在家逻辑， 不要磨蹭， 先快速搞完简单的， 然后在搞难的， 遇到超过两个小时的问题， 直接过， 之后在看
7. 一定要边开发， 边看需求文档确认, 不要被ue图蒙蔽
8. 提测之前一定要把所有的功能过一遍， 要细， 把bug控制在一定数目以下,

开发前一定要看代码，根据实际复杂程度分析

做好思考， 有问题积极复盘， 总结原因， 提升自己, 评时间一定要把会议、周五还有、上线算进去



react-native 问题总结


搭建环境

1. 需要react-native link  在安卓和ios项目中全局安装

2. ios项目pods的安装可能有问题， 需要在ios目录下手动pod install 重新安装


3. [!] No podspec found for `RNVectorIcons` in `../node_modules/react-native-vector-icons`  缺少图标依赖  ， 解决方式 yarn add react-native-vector-icons

4. 要先启动安卓模拟器， 才能启动安卓项目， 如果模拟器不自动启动的话

5. 安卓除了编译器还有很多jdk的版本需要符合

6. java 版本需要是11

7. 安卓启动报错 Error:Execution failed for task ':app:validateSigningDebug'. > Keystore file D:\Android_keystore\deb  解决方式： 把安卓staio里面把Store File里指定的Keystore文件的路径删除就可以了
